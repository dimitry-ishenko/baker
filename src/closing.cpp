////////////////////////////////////////////////////////////////////////////////
// Copyright (c) 2016 Dimitry Ishenko
// Distributed under the GNU GPL v2. For full terms please visit:
// http://www.gnu.org/licenses/gpl.html
//
// Contact: dimitry (dot) ishenko (at) (gee) mail (dot) com

////////////////////////////////////////////////////////////////////////////////
#include "closing.hpp"

////////////////////////////////////////////////////////////////////////////////
namespace pie
{

////////////////////////////////////////////////////////////////////////////////
closing::closing(asio::io_service& io) :
    sigset_(io, SIGINT, SIGTERM)
{
    sigset_.async_wait([this](const asio::error_code&, int) { close(); });
}

////////////////////////////////////////////////////////////////////////////////
closing::~closing() noexcept { }

////////////////////////////////////////////////////////////////////////////////
void closing::close() noexcept
{
    asio::error_code ec;
    sigset_.cancel(ec);
}

////////////////////////////////////////////////////////////////////////////////
}
